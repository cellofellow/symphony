# Generated by Django 2.0.2 on 2018-03-23 23:22

from django.db import migrations, models


DIFFICULTY_MAP = {0: None,
                  1: 'BEGINNER',
                  2: 'INTERMEDIATE',
                  3: 'ADVANCED',
                  4: 'PROFESSIONAL'}
FORWARDS_QUERY = """
                 UPDATE library_piece
                 SET "difficulty_new" = %s
                 WHERE "difficulty" = %s
                 """
FORWARDS = [(FORWARDS_QUERY, [v, k]) for k, v in DIFFICULTY_MAP.items()]
REVERSE_QUERY = """
                UPDATE library_piece
                SET difficulty = %s
                WHERE difficulty_new = %s
                """
REVERSE = [(REVERSE_QUERY, [k, v]) for k, v in DIFFICULTY_MAP.items()]


class Migration(migrations.Migration):

    dependencies = [
        ('library', '0009_score_type_to_choices'),
    ]

    operations = [
        migrations.AddField(
            model_name='piece',
            name='difficulty_new',
            field=models.CharField(blank=True, choices=[('BEGINNER', 'Beginner'), ('INTERMEDIATE', 'Intermediate'), ('ADVANCED', 'Advanced'), ('PROFESSIONAL', 'Professional')], max_length=12, null=True, verbose_name='Difficulty Level'),
        ),
        migrations.RunSQL(FORWARDS, REVERSE),
        migrations.RemoveField(
            model_name='piece',
            name='difficulty',
        ),
        migrations.RenameField(
            model_name='piece',
            old_name='difficulty_new',
            new_name='difficulty',
        ),
    ]
